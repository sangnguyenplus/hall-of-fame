<?php

namespace Whozidis\HallOfFame\Forms;

use Botble\Base\Forms\FormAbstract;
use Botble\Base\Enums\BaseStatusEnum;
use Whozidis\HallOfFame\Http\Requests\VulnerabilityReportRequest;
use Whozidis\HallOfFame\Models\VulnerabilityReport;

class VulnerabilityReportForm extends FormAbstract
{
    public function buildForm(): void
    {
        $this
            ->setupModel(new VulnerabilityReport())
            ->setValidatorClass(VulnerabilityReportRequest::class)
            ->withCustomFields()
            ->add('title', 'text', [
                'label' => trans('core/base::forms.title'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'placeholder' => trans('core/base::forms.title'),
                    'data-counter' => 120,
                ],
            ])
            ->add('vulnerability_type', 'text', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.vulnerability_type'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.vulnerability_type_placeholder'),
                    'data-counter' => 255,
                ],
            ])
            ->add('endpoint', 'text', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.endpoint'),
                'label_attr' => ['class' => 'control-label'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.endpoint_placeholder'),
                    'data-counter' => 255,
                ],
            ])
            ->add('description', 'editor', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.description'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.description_placeholder'),
                    'with-short-code' => false,
                ],
            ])
            ->add('impact', 'editor', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.impact'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.impact_placeholder'),
                    'with-short-code' => false,
                ],
            ])
            ->add('steps_to_reproduce', 'editor', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.steps_to_reproduce'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.steps_to_reproduce_placeholder'),
                    'with-short-code' => false,
                ],
            ])
            ->add('suggested_fix', 'editor', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.suggested_fix'),
                'label_attr' => ['class' => 'control-label'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.suggested_fix_placeholder'),
                    'with-short-code' => false,
                ],
            ])
            ->add('researcher_info', 'html', [
                'html' => '<h4>' . trans('plugins/hall-of-fame::vulnerability-reports.researcher_info') . '</h4>',
            ])
            ->add('researcher_name', 'text', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.researcher_name'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.researcher_name_placeholder'),
                    'data-counter' => 255,
                ],
            ])
            ->add('researcher_bio', 'textarea', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.researcher_bio'),
                'label_attr' => ['class' => 'control-label'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.researcher_bio_placeholder'),
                    'rows' => 3,
                ],
            ])
            ->add('researcher_email', 'email', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.researcher_email'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.researcher_email_placeholder'),
                    'data-counter' => 255,
                ],
            ])
            ->add('status_info', 'html', [
                'html' => '<h4>' . trans('plugins/hall-of-fame::vulnerability-reports.status_info') . '</h4>',
            ])
            ->add('status', 'customSelect', [
                'label' => trans('core/base::tables.status'),
                'label_attr' => ['class' => 'control-label required'],
                'attr' => [
                    'class' => 'form-control select-full',
                ],
                'choices' => BaseStatusEnum::labels(),
            ])
            ->add('is_published', 'onOff', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.is_published'),
                'label_attr' => ['class' => 'control-label'],
                'default_value' => false,
            ])
            ->add('admin_note', 'textarea', [
                'label' => trans('plugins/hall-of-fame::vulnerability-reports.admin_note'),
                'label_attr' => ['class' => 'control-label'],
                'attr' => [
                    'placeholder' => trans('plugins/hall-of-fame::vulnerability-reports.admin_note_placeholder'),
                    'rows' => 3,
                ],
            ]);
    }
}
