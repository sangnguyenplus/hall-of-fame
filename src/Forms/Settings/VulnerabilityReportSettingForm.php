<?php

namespace Whozidis\HallOfFame\Forms\Settings;

use Botble\Base\Forms\FieldOptions\OnOffFieldOption;
use Botble\Base\Forms\FieldOptions\TextareaFieldOption;
use Botble\Base\Forms\FieldOptions\TextFieldOption;
use Botble\Base\Forms\Fields\OnOffField;
use Botble\Base\Forms\Fields\TextareaField;
use Botble\Base\Forms\Fields\TextField;
use Botble\Setting\Forms\SettingForm;
use Whozidis\HallOfFame\Http\Requests\Settings\VulnerabilityReportSettingRequest;

class VulnerabilityReportSettingForm extends SettingForm
{
    public function setup(): void
    {
        parent::setup();

        $this
            ->setSectionTitle(trans('plugins/hall-of-fame::settings.vulnerability_reports.title'))
            ->setSectionDescription(trans('plugins/hall-of-fame::settings.vulnerability_reports.description'))
            ->setValidatorClass(VulnerabilityReportSettingRequest::class)
            ->add(
                'hall_of_fame_reports_auto_publish',
                OnOffField::class,
                OnOffFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.auto_publish'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.auto_publish_helper'))
                ->value((int) setting('hall_of_fame_reports_auto_publish', 0))
            )
            ->add(
                'hall_of_fame_reports_require_approval',
                OnOffField::class,
                OnOffFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.require_approval'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.require_approval_helper'))
                ->value((int) setting('hall_of_fame_reports_require_approval', 1))
            )
            ->add(
                'hall_of_fame_reports_email_notifications',
                OnOffField::class,
                OnOffFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.email_notifications'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.email_notifications_helper'))
                ->value((int) setting('hall_of_fame_reports_email_notifications', 1))
            )
            ->add(
                'hall_of_fame_reports_allow_anonymous',
                OnOffField::class,
                OnOffFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.allow_anonymous'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.allow_anonymous_helper'))
                ->value((int) setting('hall_of_fame_reports_allow_anonymous', 0))
            )
            ->add(
                'hall_of_fame_reports_max_file_size',
                TextField::class,
                TextFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.max_file_size'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.max_file_size_helper'))
                ->value(setting('hall_of_fame_reports_max_file_size', 50))
                ->attributes(['type' => 'number', 'min' => '1', 'max' => '500'])
            )
            ->add(
                'hall_of_fame_reports_allowed_file_types',
                TextareaField::class,
                TextareaFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.allowed_file_types'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.allowed_file_types_helper'))
                ->value(setting('hall_of_fame_reports_allowed_file_types', 'pdf,doc,docx,txt,png,jpg,jpeg,gif,eml,mp4,avi,mov,wmv,flv,webm,mkv,m4v'))
                ->rows(3)
            )
            ->add(
                'hall_of_fame_reports_severity_required',
                OnOffField::class,
                OnOffFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.severity_required'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.severity_required_helper'))
                ->value((int) setting('hall_of_fame_reports_severity_required', 1))
            )
            ->add(
                'hall_of_fame_reports_auto_generate_certificates',
                OnOffField::class,
                OnOffFieldOption::make()
                ->label(trans('plugins/hall-of-fame::settings.vulnerability_reports.auto_generate_certificates'))
                ->helperText(trans('plugins/hall-of-fame::settings.vulnerability_reports.auto_generate_certificates_helper'))
                ->value((int) setting('hall_of_fame_reports_auto_generate_certificates', 0))
            );
    }
}
